<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sahastra Ghatt Puja Invitation</title>
    
    <!-- Open Graph Meta Tags for WhatsApp Sharing -->
    <meta property="og:title" content="सहस्त्र घट महापूजन निमंत्रण 🙏" />
    <meta property="og:description" content="प्रियजन, आपको सपरिवार आमंत्रित करते हैं: 🔱 सहस्त्र घट पूजन एवं महाप्रसाद | 🗓️ रविवार, 3 अगस्त 2025, 🕔 शाम 5 बजे | 📍 शिव मंदिर, कमल अपार्टमेंट 1, बानी पार्क, जयपुर | 🌸 आपकी उपस्थिति हमारे लिए सौभाग्य होगी। ☎️ संपर्क: श्री राम गोपाल शर्मा – 9602570948" />
    <meta property="og:image" content="https://i.imgur.com/Y5qOG0w.png" />
    <meta property="og:url" content="https://khushahal.github.io/invitation/" />
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet" />
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- Vanilla Tilt for card tilt effect -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.2/vanilla-tilt.min.js"></script>
    <style>
        /* Main body with background */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #fefce8, #fed7aa, #f97316);
            font-family: 'Noto Sans Devanagari', sans-serif;
            padding: 1rem;
            box-sizing: border-box;
            /* overflow: hidden;  <-- THIS LINE WAS REMOVED TO ENABLE SCROLLING */
        }
        
        #ripple-canvas {
            position: fixed; /* Use fixed to ensure it covers the viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none; /* Allows clicks to pass through */
        }

        /* Container to constrain the width */
        .invitation-container {
            width: 100%;
            max-width: 420px; /* Mobile-first constraint */
            position: relative;
            z-index: 2; /* Ensure invitation is above the ripple canvas */
            margin: auto; /* Ensures it stays centered */
        }
        
        .card-container {
            background: linear-gradient(135deg, #4c1d95, #7c3aed, #a855f7);
            border-radius: 24px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
            width: 100%;
            padding: 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 4px solid transparent;
            animation: glowingBorder 4s ease-in-out infinite;
            transform-style: preserve-3d;
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        }
        /* Touch animation for mobile */
        .card-container.is-touched {
            transform: scale(1.03);
            box-shadow: 0 25px 55px rgba(0,0,0,0.6);
            transition: transform 0.15s ease-out, box-shadow 0.15s ease-out;
        }

        @keyframes glowingBorder {
            0%, 100% { border-color: #facc15; box-shadow: 0 0 20px rgba(250, 204, 21, 0.6); }
            50% { border-color: #fef08a; box-shadow: 0 0 30px rgba(250, 204, 21, 0.9); }
        }
        .card-container::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-image: url('https://i.imgur.com/n3hK7Zy.png');
            background-size: cover; background-position: center;
            opacity: 0.1; z-index: -1; border-radius: 24px;
        }
        .mandala-image {
            position: absolute; top: -15%; left: -15%; width: 130%; height: 130%;
            object-fit: cover; opacity: 0.4; z-index: -1;
            will-change: transform; animation: rotateMandala 20s linear infinite;
        }
        @keyframes rotateMandala { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        .shiva-ganga {
            position: absolute; top: 5%; left: 5%; width: 120px; height: 120px;
            object-fit: cover; opacity: 0; z-index: 0; will-change: transform, opacity;
            animation: fadeInShiva 1s ease-in-out 5s forwards, floatShiva 4s ease-in-out infinite 5s;
        }
        @keyframes fadeInShiva { from { opacity: 0; transform: scale(0.8); } to { opacity: 0.3; transform: scale(1); } }
        @keyframes floatShiva { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        
        .content-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            border-radius: 20px; position: relative; z-index: 2;
            border: 2px solid rgba(250, 204, 21, 0.4);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            padding: 1rem;
        }
        .shiva-image {
            width: 7rem; height: 7rem; /* w-28 h-28 */
            object-fit: cover; border-radius: 50%; border: 4px solid #facc15;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: floatGlow 3.5s ease-in-out infinite; transform-style: preserve-3d;
        }
        @keyframes floatGlow {
            0%, 100% { transform: translateY(0) rotateY(0deg); box-shadow: 0 0 20px rgba(250, 204, 21, 0.6); }
            50% { transform: translateY(-10px) rotateY(5deg); box-shadow: 0 0 30px rgba(250, 204, 21, 0.9); }
        }
        .map-container {
            width: 100%; height: 200px; border-radius: 12px; overflow: hidden;
            margin-top: 1.5rem; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
            border: 2px solid #facc15; display: none; opacity: 0;
            transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .map-container.active { display: block; opacity: 1; transform: translateY(0); }
        .map-container iframe { width: 100%; height: 100%; border: 0; }
        .cinzel-font { font-family: 'Cinzel', serif; }
        
        .copy-message, .audio-message {
            position: fixed; background-color: #4CAF50; color: white; padding: 10px 20px;
            border-radius: 8px; font-size: 0.875rem; top: 20px;
            left: 50%; transform: translateX(-50%); opacity: 0;
            transition: opacity 0.4s ease-in-out; z-index: 1000;
        }
        .audio-message { background-color: #1e40af; top: 60px; }
        .copy-message.visible, .audio-message.visible { opacity: 1; }
        
        button {
            position: relative; overflow: hidden; transition: all 0.3s ease; transform-style: preserve-3d;
        }
        button:hover {
            transform: scale(1.05) translateY(-3px) rotateX(5deg);
            box-shadow: 0 0 25px rgba(250, 204, 21, 0.8);
        }
    </style>
</head>
<body>
    <canvas id="ripple-canvas"></canvas>
    <div class="invitation-container">
        <div class="card-container">
            <img src="https://i.imgur.com/n3hK7Zy.png" onerror="this.onerror=null;this.src='https://placehold.co/600x600/000000/FFFFFF?text=Mandala';" alt="Om Namah Shivaya Mandala" class="mandala-image" />
            <img src="https://i.imgur.com/5j8B7xT.jpg" onerror="this.onerror=null;this.src='https://placehold.co/200x200/FFFFFF/000000?text=Shiva';" alt="Lord Shiva with Ganga" class="shiva-ganga" />
            
            <div class="content-panel">
                <img src="https://i.imgur.com/Y5qOG0w.png"
                     onerror="this.onerror=null;this.src='https://placehold.co/120x120/6B4226/FFFFFF?text=Shiva';"
                     alt="Lord Shiva meditating" class="shiva-image mx-auto mb-6" />

                <h1 class="text-2xl font-extrabold text-red-900 mb-4 cinzel-font">
                    <span class="text-yellow-500">🙏</span> Sahastra Ghatt Invitation <span class="text-yellow-500">🙏</span>
                </h1>

                <hr class="border-t-2 border-yellow-500 w-36 mx-auto mb-6" />

                <p class="text-lg text-gray-900 mb-6 italic cinzel-font">
                    <span lang="hi">ॐ नमः शिवाय</span>
                </p>

                <p class="text-base text-gray-800 mb-6">
                    With the divine blessings of Devadidev Mahadev, we joyfully invite you and your family to partake in the auspicious <strong>Sahastra Ghatt</strong> to seek prosperity, peace, and well-being.
                </p>

                <hr class="border-t-2 border-yellow-500 w-36 mx-auto" />

                <!-- Event Details Card -->
                <div class="bg-amber-50/70 rounded-xl p-4 mt-6 border border-amber-300/50 shadow-inner">
                    <h3 class="text-xl font-bold text-red-900 mb-4 cinzel-font text-center">Event Details:</h3>
                    <div class="text-left text-base text-gray-800 space-y-4">
                        <div class="flex items-start gap-x-3">
                            <span class="text-yellow-500 text-xl mt-1">🗓️</span>
                            <div><strong class="font-semibold text-gray-900">Date:</strong> <span id="eventDate"></span></div>
                        </div>
                        <div class="flex items-start gap-x-3">
                            <span class="text-yellow-500 text-xl mt-1">⏰</span>
                            <div><strong class="font-semibold text-gray-900">Time:</strong> 5:00 PM onwards</div>
                        </div>
                        <div class="flex items-start gap-x-3">
                            <span class="text-yellow-500 text-xl mt-1">📍</span>
                            <div><strong class="font-semibold text-gray-900">Venue:</strong> Shiv Mandir, Kamal Apartment 1, Jaipur</div>
                        </div>
                         <div class="flex items-start gap-x-3">
                            <span class="text-yellow-500 text-xl mt-1">🗺️</span>
                            <div><strong class="font-semibold text-gray-900">Map:</strong> <a href="https://www.google.com/maps/search/?api=1&query=WQGM%2B7J9+Kamal%20Apartment%201,%20Ram%20Mandir%20Rd,%20Bani%20Park,%20Jaipur,%20Rajasthan%20302016" target="_blank" class="text-blue-600 hover:underline">View Here</a></div>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col justify-center items-center gap-4 mt-8">
                    <button id="viewMapBtn" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg">
                        <span class="mr-1">🗺️</span> View Map
                    </button>
                    <button id="playPauseMantraBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg" disabled>
                        <span class="mr-1">🎶</span> Play Mantra
                    </button>
                    <button id="shareBtn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg">
                        <span class="mr-1">📲</span> Share
                    </button>
                </div>

                <div id="mapSection" class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3558.125139789718!2d75.79975767500588!3d26.900989360814923!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x396db30182650001%3A0x2720d2c94a5e12e!2sShiv%20Mandir%2C%20Kamal%20Apartment%201%2C%20Ram%20Mandir%20Rd%2C%20Bani%20Park%2C%20Jaipur%20Rajasthan%20302016!5e0!3m2!1sen!2sin!4v1700000000000!5m2!1sen!2sin" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                
                <p class="text-base text-gray-800 mt-8">
                    Your esteemed presence will make this occasion truly special.
                </p>

                <!-- With Best Regards Card -->
                <div class="bg-amber-50/70 rounded-xl p-4 mt-6 border border-amber-300/50 shadow-inner">
                    <p class="text-base font-semibold text-red-900 mb-2 cinzel-font">
                        With Best Regards,
                    </p>
                    <div class="text-base text-gray-800">
                        <p>Mr Ram Gopal Sharma & Family</p>
                        <div class="flex items-center justify-center mt-2">
                            <span>Mob: 9602570948</span>
                            <button id="copyMobBtn" aria-label="Copy mobile number" class="ml-2 bg-gray-200 hover:bg-gray-300 text-gray-700 text-xs py-1 px-2 rounded-md">
                                Copy
                            </button>
                        </div>
                    </div>
                </div>

                <span id="copyMessage" class="copy-message">Copied!</span>
                <span id="audioMessage" class="audio-message">Click "Play Mantra" to start the audio</span>
            </div>
        </div>
    </div>

    <audio id="mantraAudio" loop>
        <source src="https://cdn.pixabay.com/audio/2024/09/12/audio_abf0e340ff.mp3" type="audio/mpeg">
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const isTouchDevice = () => 'ontouchstart' in window || navigator.maxTouchPoints > 0;

            // --- Ganga Jal Ripple Effect ---
            const canvas = document.getElementById('ripple-canvas');
            const ctx = canvas.getContext('2d');
            let ripples = [];

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resizeCanvas();

            function createRipple(e) {
                const x = e.clientX || (e.touches && e.touches[0].clientX);
                const y = e.clientY || (e.touches && e.touches[0].clientY);
                if (x === undefined) return;

                ripples.push({
                    x: x,
                    y: y,
                    radius: 0,
                    opacity: 1,
                    speed: 1.5,
                    lineWidth: 3
                });
            }

            function animateRipples() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                for (let i = ripples.length - 1; i >= 0; i--) {
                    let r = ripples[i];
                    r.radius += r.speed;
                    r.opacity -= 0.02;
                    r.lineWidth -= 0.05;

                    if (r.opacity <= 0) {
                        ripples.splice(i, 1);
                        continue;
                    }

                    ctx.beginPath();
                    ctx.arc(r.x, r.y, r.radius, 0, Math.PI * 2);
                    ctx.strokeStyle = `rgba(255, 255, 255, ${r.opacity})`;
                    ctx.lineWidth = Math.max(0, r.lineWidth);
                    ctx.stroke();
                }
                requestAnimationFrame(animateRipples);
            }
            
            window.addEventListener('resize', resizeCanvas);
            document.body.addEventListener('click', createRipple);
            document.body.addEventListener('touchstart', createRipple, { passive: true });
            animateRipples();
            // --- End Ripple Effect ---


            // Populate date immediately
            try {
                const eventDate = new Date('2025-08-03T17:00:00');
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('eventDate').textContent = eventDate.toLocaleDateString('en-US', options);
            } catch (e) {
                console.error("Date formatting failed:", e);
                document.getElementById('eventDate').textContent = 'Sunday, August 3, 2025';
            }

            // GSAP Animations
            if (typeof gsap !== 'undefined') {
                gsap.from('.shiva-image, h1, hr, p, .bg-amber-50\\/70, .flex-col', {
                    opacity: 0, y: 20, duration: 1, stagger: 0.1, ease: 'power3.out',
                });
            }

            // Card Animations: Tilt for Desktop, Touch for Mobile
            const card = document.querySelector('.card-container');
            if (card) {
                if (!isTouchDevice() && typeof VanillaTilt !== 'undefined') {
                    VanillaTilt.init(card, {
                        max: 8, speed: 400, perspective: 1000, glare: true, 'max-glare': 0.2
                    });
                } else {
                    card.addEventListener('touchstart', () => card.classList.add('is-touched'), { passive: true });
                    card.addEventListener('touchend', () => card.classList.remove('is-touched'));
                    card.addEventListener('touchcancel', () => card.classList.remove('is-touched'));
                }
            }

            // Map Toggle
            const viewMapBtn = document.getElementById('viewMapBtn');
            const mapSection = document.getElementById('mapSection');
            if (viewMapBtn && mapSection) {
                viewMapBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    mapSection.classList.toggle('active');
                });
            }

            // Copy Mobile Number
            const copyMobBtn = document.getElementById('copyMobBtn');
            const copyMessage = document.getElementById('copyMessage');
            if (copyMobBtn && copyMessage) {
                copyMobBtn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent ripple from firing on button click
                    navigator.clipboard.writeText('9602570948').then(() => {
                        copyMessage.classList.add('visible');
                        setTimeout(() => copyMessage.classList.remove('visible'), 2000);
                    }).catch(err => console.error('Failed to copy:', err));
                });
            }
            
            // Share on WhatsApp
            const shareBtn = document.getElementById('shareBtn');
            if(shareBtn) {
                shareBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const text = `🙏 You are cordially invited to the Sahastra Ghatt Puja 🙏\n\nJoin us for this auspicious occasion to seek divine blessings.\n\n🗓️ Date: Sunday, August 3, 2025\n⏰ Time: 5:00 PM onwards\n📍 Venue: Shiv Mandir, Kamal Apartment 1, Jaipur\n\nView the full invitation:`;
                    const url = 'https://khushahal.github.io/invitation/';
                    const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(text + ' ' + url)}`;
                    window.open(whatsappUrl, '_blank');
                });
            }

            // Audio Controls
            const mantraAudio = document.getElementById('mantraAudio');
            const playPauseMantraBtn = document.getElementById('playPauseMantraBtn');
            const audioMessage = document.getElementById('audioMessage');
            
            if(mantraAudio && playPauseMantraBtn && audioMessage) {
                const showAudioMessage = (msg) => {
                    audioMessage.textContent = msg;
                    audioMessage.classList.add('visible');
                    setTimeout(() => audioMessage.classList.remove('visible'), 4000);
                };

                const updateButtonState = () => {
                    playPauseMantraBtn.innerHTML = mantraAudio.paused 
                        ? '<span class="mr-1">🎶</span> Play Mantra' 
                        : '<span class="mr-1">⏸️</span> Pause Mantra';
                };
                
                mantraAudio.addEventListener('canplaythrough', () => playPauseMantraBtn.disabled = false);
                mantraAudio.addEventListener('play', updateButtonState);
                mantraAudio.addEventListener('pause', updateButtonState);
                mantraAudio.addEventListener('error', () => {
                    playPauseMantraBtn.disabled = true;
                    playPauseMantraBtn.innerHTML = '<span class="mr-1">⚠️</span> Audio Error';
                    showAudioMessage('Audio could not be loaded.');
                });
                
                playPauseMantraBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (mantraAudio.paused) {
                        mantraAudio.play().catch(() => showAudioMessage('Autoplay blocked. Please press play.'));
                    } else {
                        mantraAudio.pause();
                    }
                });
                
                const playOnFirstInteraction = () => {
                    if(mantraAudio.paused) mantraAudio.play().catch(()=>{});
                    document.body.removeEventListener('click', playOnFirstInteraction);
                    document.body.removeEventListener('touchstart', playOnFirstInteraction);
                };
                document.body.addEventListener('click', playOnFirstInteraction);
                document.body.addEventListener('touchstart', playOnFirstInteraction);
            }
        });
    </script>
</body>
</html>
